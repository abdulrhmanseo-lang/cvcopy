import{c as n,u as L,b as M,r as i,j as e,X as I,d as $,S as A}from"./index-CXzkSHQg.js";import{t as m,L as y,g as E}from"./cvHelpers-CCilqCpX.js";import{d as P}from"./gemini-D7axwJuE.js";import{P as R,C as T}from"./CVRenderer-DoaCtvjQ.js";import{C as w}from"./chart-no-axes-column-DYp5r7Wh.js";import{L as D}from"./loader-circle-DEp0uObv.js";import{C as V}from"./circle-check-C76UPXug.js";import"./mail-vN7Sor3d.js";import"./phone-24t_htdC.js";import"./user-DhkSCJpp.js";/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],O=n("globe",K);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],F=n("pen",Z);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],J=n("printer",H);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],B=n("zoom-in",Q);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],W=n("zoom-out",G),le=()=>{var f;const o=L(),{showToast:d}=M(),[t,h]=i.useState(null),[r,j]=i.useState(null),[N,b]=i.useState(!1),[v,c]=i.useState(!1),[x,l]=i.useState(.8),[g,p]=i.useState(!1);i.useEffect(()=>{const s=localStorage.getItem("cv_data");s?h(JSON.parse(s)):o("/builder")},[o]),i.useEffect(()=>{const s=()=>{const a=window.innerWidth;a<850?l((a-40)/794):a<1200?l(.7):l(.85)};return window.addEventListener("resize",s),s(),()=>window.removeEventListener("resize",s)},[]);const k=async()=>{if(t){p(!0);try{await E("cv-root",t.fullName,t.language),d("تم تحميل السيرة الذاتية بنجاح!","success")}catch(s){console.error(s),d("حدث خطأ أثناء تحميل الملف.","error")}finally{p(!1)}}},z=async()=>{if(!t)return;b(!0),c(!0);const s=await P(t);j(s),b(!1)},C=s=>{if(!t)return;const a=m.find(_=>_.id===s),S=(a==null?void 0:a.lang)==="ar"?y.Arabic:y.English,u={...t,templateId:s,language:S};h(u),localStorage.setItem("cv_data",JSON.stringify(u))};return t?e.jsxs("div",{className:"bg-dark min-h-screen flex flex-col font-sans",children:[e.jsx("div",{className:"bg-card/90 backdrop-blur-md border-b border-white/5 sticky top-[70px] md:top-[80px] z-30 shadow-2xl no-print",children:e.jsx("div",{className:"container mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>o("/builder"),className:"bg-white/10 p-2 rounded-full text-white hover:bg-white/20",children:e.jsx(F,{size:18})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-white font-bold text-sm md:text-base",children:t.fullName}),e.jsxs("p",{className:"text-gray-500 text-xs",children:["قالب: ",(f=m.find(s=>s.id===t.templateId))==null?void 0:f.name]})]})]}),e.jsxs("div",{className:"hidden md:flex bg-white/5 rounded-lg border border-white/10 p-1",children:[e.jsx("button",{onClick:()=>l(s=>Math.max(.4,s-.1)),className:"p-2 hover:bg-white/10 text-white",children:e.jsx(W,{size:16})}),e.jsxs("span",{className:"px-2 text-xs text-gray-400 flex items-center",children:[Math.round(x*100),"%"]}),e.jsx("button",{onClick:()=>l(s=>Math.min(1.5,s+.1)),className:"p-2 hover:bg-white/10 text-white",children:e.jsx(B,{size:16})})]})]}),e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide",children:m.map(s=>e.jsx("button",{onClick:()=>C(s.id),className:`text-xs px-3 py-1.5 rounded-full whitespace-nowrap border transition-all ${t.templateId===s.id?"bg-primary text-white border-primary":"bg-white/5 text-gray-400 border-white/10"}`,children:s.name},s.id))}),e.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[e.jsxs("button",{onClick:z,className:"flex items-center justify-center gap-1 bg-indigo-500/10 text-indigo-400 border border-indigo-500/20 rounded-xl font-bold hover:bg-indigo-500/20 text-xs",children:[e.jsx(w,{size:16})," ",e.jsx("span",{className:"hidden sm:inline",children:"تحليل"})]}),e.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(window.location.href),d("تم نسخ الرابط","success")},className:"flex items-center justify-center gap-1 bg-white/5 text-gray-300 border border-white/10 rounded-xl font-bold hover:bg-white/10 text-xs",children:[e.jsx(O,{size:16})," ",e.jsx("span",{className:"hidden sm:inline",children:"نشر"})]}),e.jsxs("button",{onClick:()=>d("قريباً: رمز QR للملف الشخصي","success"),className:"flex items-center justify-center gap-1 bg-white/5 text-gray-300 border border-white/10 rounded-xl font-bold hover:bg-white/10 text-xs",children:[e.jsx(R,{size:16}),"  ",e.jsx("span",{className:"hidden sm:inline",children:"QR"})]}),e.jsxs("button",{onClick:k,disabled:g,className:"flex items-center justify-center gap-1 bg-primary text-white rounded-xl font-bold hover:bg-primary-dark transition-all shadow-lg active:scale-95 text-xs",children:[g?e.jsx("div",{className:"w-3 h-3 border-2 border-white/30 border-t-white rounded-full animate-spin"}):e.jsx(J,{size:16})," ",e.jsx("span",{className:"hidden sm:inline",children:"PDF"})]})]})]})})}),e.jsx("div",{className:"flex-1 bg-[#0f0f0f] relative overflow-auto flex justify-center pt-8 pb-32",children:e.jsx("div",{className:"bg-white shadow-2xl transition-transform duration-200 origin-top",style:{width:"210mm",minHeight:"297mm",transform:`scale(${x})`,marginBottom:`-${(1-x)*297}mm`},children:e.jsx(T,{data:t})})}),v&&e.jsx("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-md z-[60] flex items-end md:items-center justify-center p-0 md:p-4 no-print animate-fade-in",children:e.jsxs("div",{className:"bg-[#1a1a1a] border-t md:border border-white/10 w-full md:max-w-2xl rounded-t-3xl md:rounded-3xl shadow-2xl overflow-hidden max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"p-6 bg-gradient-to-br from-primary/20 to-transparent flex justify-between items-center border-b border-white/5",children:[e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[e.jsx(w,{className:"text-primary-light"})," تحليل Score"]}),e.jsx("button",{onClick:()=>c(!1),className:"bg-white/10 p-2 rounded-full text-white",children:e.jsx(I,{size:18})})]}),e.jsx("div",{className:"p-6 overflow-y-auto",children:N?e.jsxs("div",{className:"text-center py-10",children:[e.jsx(D,{size:40,className:"text-primary animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"جاري فحص السيرة الذاتية..."})]}):r?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:`relative w-32 h-32 rounded-full flex flex-col items-center justify-center border-8 ${r.score>=80?"border-green-500 text-green-500":r.score>=50?"border-yellow-500 text-yellow-500":"border-red-500 text-red-500"}`,children:[e.jsx("span",{className:"text-4xl font-black",children:r.score}),e.jsx("span",{className:"text-xs font-bold uppercase text-gray-400",children:"Score"})]})}),r.missingKeywords&&r.missingKeywords.length>0&&e.jsxs("div",{className:"bg-red-500/10 p-4 rounded-xl border border-red-500/20",children:[e.jsxs("h3",{className:"font-bold text-red-400 mb-3 flex items-center gap-2",children:[e.jsx($,{size:16})," كلمات مفتاحية ناقصة"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:r.missingKeywords.map((s,a)=>e.jsx("span",{className:"px-2 py-1 bg-red-500/20 text-red-300 text-xs rounded-lg border border-red-500/20",children:s},a))})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white/5 p-4 rounded-xl border border-white/5",children:[e.jsxs("h3",{className:"font-bold text-white mb-2 flex items-center gap-2",children:[e.jsx(V,{size:16,className:"text-blue-400"})," التحليل العام"]}),e.jsx("p",{className:"text-gray-300 text-xs leading-relaxed",children:r.feedback})]}),e.jsxs("div",{className:"bg-white/5 p-4 rounded-xl border border-white/5",children:[e.jsxs("h3",{className:"font-bold text-white mb-2 flex items-center gap-2",children:[e.jsx(A,{size:16,className:"text-yellow-400"})," طابق الشركة"]}),e.jsx("p",{className:"text-gray-300 text-xs leading-relaxed",children:r.companyFit})]})]}),e.jsx("button",{onClick:()=>{c(!1),o("/builder")},className:"w-full py-4 bg-gradient-to-r from-primary to-indigo-600 text-white rounded-xl font-bold hover:shadow-lg hover:shadow-primary/25 transition-all",children:"تحسين السيرة الذاتية الآن"})]}):null})]})})]}):e.jsx("div",{className:"min-h-screen bg-dark flex items-center justify-center text-white",children:"Loading..."})};export{le as default};
